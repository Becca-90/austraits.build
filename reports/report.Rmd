```{r, echo=FALSE, results="hide", message=FALSE, warning=FALSE}
key <- data_study$key
definitions_traits_numeric <- subset(definitions_traits, type == "numeric")
# does dataset contain numeric data?
show_plot <- any(unique(data_study$data$trait_name) %in% definitions_traits_numeric$trait_name)
knitr::opts_chunk$set(echo=FALSE, fig.cap='', cache=FALSE)
```

```{r, echo=FALSE, results="hide", message=FALSE, warning=FALSE, eval=show_plot}
formatted <- format_data(data_study$key, data_study, austraits, definitions_traits_numeric) # format data for plotting
```

# Report for study: `r key`

## People

```{r, results='asis', echo=FALSE}
tab <- list_to_df(data_study$metadata$people)
kable(na.omit(tab), "markdown", align="l", padding=10)
```

## Overview of data provided

The dataset includes `r nrow(data_study$data)` individual datapoints from `r length(unique(data_study$data$species_name))` species, with data included for the following `r length(unique(data_study$data$trait_name))` traits: `r paste(unique(data_study$data$trait_name), collapse = ", ")`.

```{r summary_table, results='asis', echo=FALSE}
tab <- summ(data_study$data)
kable(tab, "markdown", align="l", padding=10)
```

```{r, results='asis', echo=FALSE, eval = show_plot}
writeLines(sprintf("## Diagnostic plots of numeric data
### Pairwise plots for %s, log10 axes",key))
```

```{r pairwise_plots, fig.width=12, fig.height=9, echo=FALSE, message=FALSE, warning=FALSE, eval = show_plot}
pairwise_panel2(key, formatted)
```

### Cleveland dotcharts for `r key`, log10 axes

```{r dotchart, fig.width=12, fig.height=9, echo=FALSE, message=FALSE, warning=FALSE, eval = show_plot}
dotcharts(key, formatted)
```

### Metadata.yml

```{r, echo=FALSE, results='asis'}
paste0(readLines(sprintf("../data/%s/metadata.yml", key)))
```


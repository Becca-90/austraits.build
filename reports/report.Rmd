```{r, echo=FALSE, results="hide", message=FALSE, warning=FALSE}
setwd('../')
source('code/report_functions.R')
key <- data_study$key
definitions_traits_numeric <- subset(read_csv('config/definitions_traits.csv'), type == "numeric")
show_plot <- has_numeric(data_study$data)
```

```{r, echo=FALSE, results="hide", message=FALSE, warning=FALSE, eval=show_plot}
setwd('../')
formatted <- format_data(data_study$key) # format data for plotting
```

# Report for study: `r key`

## Contact Information

**Data contributor:** `r data_study$metadata$data_contributor`

## Overview of data provided

The dataset includes `r nrow(data_study$data)` individual datapoints from `r length(unique(data_study$data$species_name))` species, with data included for the following `r length(unique(data_study$data$trait_name))` traits: `r paste(unique(data_study$data$trait_name), collapse = ", ")`.

```{r summary_table, results='asis', echo=FALSE}
tab <- summ(data_study$data)
kable(tab, "markdown", align="l", padding=10)
```

## Diagnostic plots of numeric data
####Pairwise plots for `r key`, log10 axes####

```{r pairwise_plots, fig.width=12, fig.height=9, echo=FALSE, message=FALSE, warning=FALSE, eval = show_plot}
#ifelse(has_numeric(data_study$data), pairwise_panel(key, formatted), print('No numeric data'))
pairwise_panel2(key, formatted)
```

####Cleveland dotcharts for `r key`, log10 axes####

```{r dotchart, fig.width=12, fig.height=9, echo=FALSE, message=FALSE, warning=FALSE, eval = show_plot}
#ifelse(has_numeric(data_study$data), dotcharts(key, formatted), print('No numeric data'))
dotcharts(key, formatted)
```
